<!doctype html>
<html>
  <head>
    <title>Enemy Death Animation Test</title>
    <script type="module">
      import { Game } from './public/src/core/game.js';

      window.addEventListener('DOMContentLoaded', async () => {
        console.log('Starting enemy death animation test...');

        const game = new Game();
        window.game = game;

        await game.init();

        // Wait a bit for everything to load
        setTimeout(() => {
          // Start the game automatically
          game.startGame();

          // Wait for enemies to be spawned
          setTimeout(() => {
            console.log('Enemies loaded:', game.enemies.length);

            if (game.enemies.length > 0) {
              const enemy = game.enemies[0];
              console.log('Enemy HP before damage:', enemy.hp);
              console.log('Enemy isDead before damage:', enemy.isDead);

              // Kill the enemy
              enemy.takeDamage(enemy.hp);

              console.log('Enemy HP after damage:', enemy.hp);
              console.log('Enemy isDead after damage:', enemy.isDead);
              console.log(
                'Enemy animation after damage:',
                enemy.currentAnimationName
              );

              // Check after 3 seconds
              setTimeout(() => {
                console.log('After 3 seconds:');
                console.log('Enemy readyForRemoval:', enemy.readyForRemoval);
                console.log('Enemies remaining:', game.enemies.length);
              }, 3000);
            } else {
              console.log('No enemies found!');
            }
          }, 2000);
        }, 5000);
      });
    </script>
  </head>
  <body>
    <h1>Enemy Death Animation Test</h1>
    <p>Open browser console to see test results.</p>
  </body>
</html>
